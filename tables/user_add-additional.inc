<?php /* $Id: user_add-additional.inc,v 1.19 2004-10-09 16:27:33 turbo Exp $ */ ?>
  <form action="<?=$_SERVER["PHP_SELF"]?>" method="post" accept-charset="UTF-8">
    <input type="hidden" name="surname"            value="<?=urlencode($_REQUEST["surname"])?>">
    <input type="hidden" name="name"               value="<?=urlencode($_REQUEST["name"])?>">
    <input type="hidden" name="email"              value="<?=$_REQUEST["email"]?>">
    <input type="hidden" name="uid"                value="<?=$_REQUEST["uid"]?>">
<?php if($account_type != "forward") { ?>
    <input type="hidden" name="autogenerate"       value="<?=$_REQUEST["autogenerate"]?>">
    <input type="hidden" name="password"           value="<?=$_REQUEST["password"]?>">
    <input type="hidden" name="pwscheme"           value="<?=$_REQUEST["pwscheme"]?>">
    <input type="hidden" name="crypted"            value="<?=$_REQUEST["crypted"]?>">
<?php } else { ?>
    <input type="hidden" name="forwardingaddress"  value="<?=$_REQUEST["forwardingaddress"]?>">
<?php } ?>
    <input type="hidden" name="subbranch"          value="<?=$url["subbranch"]?>">
    <input type="hidden" name="email_domain"       value="<?=$_REQUEST["email_domain"]?>">
    <input type="hidden" name="include_additional" value="<?=$_REQUEST["include_additional"]?>">

    <table cellspacing="0" cellpadding="3" border="0">
      <th colspan="3" align="left"><?=$LANG->_('Additional account properties')?></th>
<?php if(($account_type != "forward") and $_REQUEST["autogenerate"]) { ?>
        <!-- Show the autogenerated password -->
        <tr class="<?php pql_format_table(); ?>">
          <td class="title" valign="top"><?=$LANG->_('Autogenerated password')?></td>
          <td><?=$_REQUEST["password"]?></td>
        </tr>
<?php } ?>
<?php if($_REQUEST["account_type"] == "system") { ?>
        <!-- Home directory -->
        <tr class="<?php pql_format_table(); ?>">
          <td class="title" valign="top"><?=$LANG->_('Path to homedirectory')?></td>
          <td>
<?php if(!$_REQUEST["homedirectory"]) { ?>
            <?php echo pql_format_error_span($error_text["homedirectory"]); ?>
            <input type="text" name="homedirectory" size="30" value="/tmp/<?=$_REQUEST["uid"]?>">
<?php } else { ?>
            <?=$_REQUEST["homedirectory"]?>
            <input type="hidden" name="homedirectory" value="<?=$_REQUEST["homedirectory"]?>">
<?php } ?>
          </td>
        </tr>

<?php }

	  if($_REQUEST["account_type"] == "system") {
?>
        <input type="hidden" name="loginshell" value="<?=$_REQUEST["loginshell"]?>">
<?php } ?>

<?php if($_REQUEST["account_type"] == "mail" or $_REQUEST["account_type"] == "system") { ?>
        <!-- MailMessageStore -->
        <tr class="<?php pql_format_table(); ?>">
          <td class="title"><?=$LANG->_('Path to mailbox')?></td>
          <td>
<?php	if(!$_REQUEST["maildirectory"]) { ?>
            <?php echo pql_format_error_span($error_text["maildirectory"]); ?>
            <input type="text" name="maildirectory" size="30" value="/tmp/<?=$_REQUEST["uid"]?>">
<?php	} else { ?>
            <?=$_REQUEST["maildirectory"]?>
            <input type="hidden" name="maildirectory" value="<?=$_REQUEST["maildirectory"]?>">
<?php	} ?>
          </td>
        </tr>

        <tr></tr>

        <!-- Mailhost -->
        <tr class="<?php pql_format_table(); ?>">
          <td class="title" valign="top"><?=$LANG->_('Mail server')?></td>
          <td>
            <?php echo pql_format_error_span($error_text["userhost"]); ?>
<?php	if($_REQUEST["userhost"]["qlc"]) {
			// It's defined - QmailLDAP/Controls object

			for($i=0; $_REQUEST["userhost"]["qlc"][$i]; $i++) {
?>
            <input type="radio" name="host" value="<?=$_REQUEST["userhost"]["qlc"][$i]?>" <?php
				if(!$_REQUEST["userhost"]["qlc"][1] and !$_REQUEST["userhost"]["dns"]) { 
					// This is the default, IF:
					// 1. There's only ONE QmailLDAP/Controls object
					//    AND
					// 2. There's no DNS entry
					echo "CHECKED";
				}
?>>
            <b><?=pql_maybe_idna_decode($_REQUEST["userhost"]["qlc"][$i])?></b><br>
<?php		}
		} 

		if($_REQUEST["userhost"]["dns"] and 
		   ($_REQUEST["userhost"]["qlc"] and !in_array($_REQUEST["userhost"]["dns"], $_REQUEST["userhost"]["qlc"])))
		{
			// It's defined - DNS entry
?>
            <input type="radio" name="host" value="<?=$_REQUEST["userhost"]["dns"]?>" CHECKED>
            <b><?=$_REQUEST["userhost"]["dns"]?></b><br>
<?php	} ?>
<?php	if($_REQUEST["userhost"]["dns"] or $_REQUEST["userhost"]["qlc"]) { ?>
            <input type="radio" name="host" value="usr">
<?php	} ?>
            <input type="text" name="userhost" size="30">
          </td>
        </tr>
<?php } ?>
      </th>
    </table>
  
    <input type="hidden" name="account_type"   value="<?=$_REQUEST["account_type"]?>">
    <input type="hidden" name="account_status" value="<?=$_REQUEST["account_status"]?>">
    <input type="hidden" name="page_curr"      value="two">
    <input type="hidden" name="page_next"      value="save">
    <input type="hidden" name="domain"         value="<?=$url["domain"]?>">
    <input type="hidden" name="rootdn"         value="<?=$url["rootdn"]?>">
    <br>
    <input type="submit" value="<?=$LANG->_('Save')?>">
  </form>

<?php
/*
 * Local variables:
 * mode: php
 * mode: font-lock
 * tab-width: 4
 * End:
 */
?>
